<!DOCTYPE html>
<html>
  <head>
    <title>Dibble</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.css" rel="stylesheet" media="screen">
    <link href="css/app.css" rel="stylesheet" media="screen"> 
    <link rel="stylesheet" href="css/rainbow.css">
  </head>
  <body>
    <div class="container">
        <div class="hero-unit hero-adjustments">
          <div class="row">
            <div class="span4 offset1">
                <h1 class="dibble-title"><a href="index.html">Dibble</a></h1>
            </div>
            
            <div class="span6 links">
                <a href="docs.html" class="link">Docs</a>
                <a href="https://github.com/MichaelDrogalis/dibble" class="link">Source</a>
            </div>
          </div>
          <div class="row">
          
            <div class="span5 offset1">
                <p class="tag-line">Inferential database seeding in Clojure</p>
            </div>
          </div>
      </div>
      
      <div class="row">
        <div class="span2">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li class="nav-header">Browse</li>
              <li><a href="#start">start</a></li>
              <li><a href="#values">value-of</a></li>
              <li><a href="#random">randomize</a></li>
              <li><a href="#fk  ">inherit</a></li>
              <li><a href="#options">options</a></li>
              <li><a href="#policies">policies</a></li>
              <li><a href="#support">support</a></li>
            </ul>
          </div><!--/.well --> 
        </div>
        
        <div class="span10">
            <div class="row" id="start">
            <div class="span9 well">
            <h1>Getting Started</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defproject ...
  :dependencies [[dibble.core "0.1.1-SNAPSHOT"]]
  ...)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    First off, put the dependency in your project file to download from Clojars.
                </div>
            </div>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(def db {:vendor :mysql
         :db "db-name"
         :user "user"
         :password "pass"})
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    Next, in your Clojure source file, specify a valid connection. Connection's are obtained through <a href="http://sqlkorma.com">Korma</a>, so use that syntax. Don't forget to specify the <code>:vendor</code>!
                </div>
            </div>
            </div>
            </div>
            
            <div class="row" id="values">
            <div class="span9 well">
            <h1>Values</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defseed people
  {:database db :table :people}
  (value-of :name "Mike")
  (value-of :age 21))

(seed-table people)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    <code>value-of</code> is a function that takes a column name and a value to insert into the row.
                    This is useful is you know the concrete data you want to seed with, which is often the case.
                </div>
            </div>
            </div>
            </div>
             
            <div class="row" id="random">
            <div class="span9 well">
            <h1>Randomness</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defseed people
  {:database db :table :people}
  (randomized :name)
  (randomized :lucky_number))

(seed-table people)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    <code>randomize</code> is the reason I built this library. This function will inference the underlying table
                    structure and pick a suitable value seed with. If the column 'name' is a text column, Dibble will produce some text.
                    The same goes for numeric types, and anything else that is implemented.
                </div>
            </div>
            </div>
            </div>
                                
            <div class="row" id="fk">
            <div class="span9 well">
            <h1>Foreign Keys</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defseed pets
  {:database db :table :pets}
  (inherit :pet_id)
  (randomized :name))

(defseed people
  {:database db :table :people}
  (randomized :number {:fk {pets :pet_id}}))

(seed-table people)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    Data of any substantial complexity is going to be using foreign keys. Dibble handles this gracefully.
                    <code>inherit</code> is a function that receives a value as a foreign key. The foreign key is delivered to
                    the seed by another seed via the <code>:fk</code> option. <code>:fk</code> takes a map of tables to columns
                    to push its value to.
                </div>
            </div>
            </div>
            </div>
            
            <div class="row" id="options">
            <div class="span9 well">
            <h1>Type Options</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defseed people
  {:database db :table :people :n 50}
  (randomized :name {:length 16})
  (randomized :number {:min 5 :max 10}))

(seed-table people)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    Dibble takes options to <code>randomized</code>, <code>inherit</code>, <code>value-of</code>, and <code>defseed</code>.
                    <code>:n</code> indicates the number of rows to insert. It's probably easy to determine what the rest of these do,
                    but I'll enumerate them below just in case it isn't.
                </div>
            </div>
                      
            <div class="row">
                <div class="span9">
                    <h2>String options</h2>
                    <table class="table table-striped">
                        <tr>
                            <td>Option</td>
                            <td>Usage</td>
                            <td>Description</td>
                            <td>Mutual exclusion</td>
                        </tr>
                        <tr>
                            <td><code>:min</code></td>
                            <td><code>{:min 5}</code></td>
                            <td>Minimum of 5 characters</td>
                            <td><code>:length</code></td>
                        </tr>
                        <tr>
                            <td><code>:max</code></td>
                            <td><code>{:max 8}</code></td>
                            <td>Maximum of 8 characters</td>
                            <td><code>:length</code></td>
                        </tr>
                        <tr>
                            <td><code>:length</code></td>
                            <td><code>{:length 6}</code></td>
                            <td>Length is exactly 6 characters</td>
                            <td><code>:min, :max</code></td>
                        </tr>
                        <tr>
                            <td><code>:first-name</code></td>
                            <td><code>{:subtype :first-name}</code></td>
                            <td>An English first name</td>
                            <td><code>:length, :min, :max</code></td>
                        </tr>
                        <tr>
                            <td><code>:last-name</code></td>
                            <td><code>{:subtype :last-name}</code></td>
                            <td>An English last name</td>
                            <td><code>:length, :min, :max</code></td>
                        </tr>
                        <tr>
                            <td><code>:full-name</code></td>
                            <td><code>{:subtype :full-name}</code></td>
                            <td>An English full name. String, space, string.</td>
                            <td><code>:length, :min, :max</code></td>
                        </tr>
                        <tr class="error">
                            <td><code>:spaces?</code></td>
                            <td><code>{:spaces? true}</code></td>
                            <td>String may contain spaces</td>
                            <td>Not yet implemented</td>
                        </tr>
                        <tr class="error">
                            <td><code>:symbols?</code></td>
                            <td><code>{:symbols? true}</code></td>
                            <td>String may contain symbols</td>
                            <td>Not yet implemented</td>
                        </tr>
                        <tr class="error">
                            <td><code>:digits?</code></td>
                            <td><code>{:digits? true}</code></td>
                            <td>String may contain digits</td>
                            <td>Not yet implemented</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="row">
                <div class="span9">
                    <h2>Integer & Decimal options</h2>
                    <table class="table table-striped">
                        <tr>
                            <td>Option</td>
                            <td>Usage</td>
                            <td>Description</td>
                            <td>Mutual exclusion</td>
                        </tr>
                        <tr>
                            <td><code>:min</code></td>
                            <td><code>{:min 20}</code></td>
                            <td>Minimum value of 20, inclusive</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><code>:max</code></td>
                            <td><code>{:max 80}</code></td>
                            <td>Maximum value of 80, inclusive</td>
                            <td></td>
                        </tr>
                        <tr class="error">
                            <td><code>:even?</code></td>
                            <td><code>{:even? true}</code></td>
                            <td>Generated number is even</td>
                            <td>Not yet implemented</td>
                        </tr>
                        <tr class="error">
                            <td><code>:odd?</code></td>
                            <td><code>{:odd? true}</code></td>
                            <td>Generated number is odd</td>
                            <td>Not yet implemented</td>
                        </tr>
                        <tr class="error">
                            <td><code>:prime?</code></td>
                            <td><code>{:prime? true}</code></td>
                            <td>Generated number is prime</td>
                            <td>Not yet implemented</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            </div>
            </div>
            
            
            <div class="row" id="policies">
            <div class="span9 well">
            <h1>Policies</h1>
            
            <div class="row">
                <div class="span5">
                                <pre>
                <code class="seed-code">
(defseed people
  {:database db :table :people
   :policy :clean-slate :n 200}
  (randomized :name)
  (randomized :number))

(seed-table people)
                </code>
            </pre>
                </div>
                <div class="span4 narrative">
                    Policies let Dibble know what do before writing data to a table.
                </div>
            </div>
            
                <div class="row">
                <div class="span9">
                    <h2>Policy options</h2>
                    <table class="table table-striped">
                        <tr>
                            <td>Policy</td>
                            <td>Usage</td>
                            <td>Description</td>
                        </tr>
                        <tr>
                            <td>Append</td>
                            <td><code>{:policy :append}</code></td>
                            <td>Only append to the table. Append is the default.</td>
                        </tr>
                        <tr>
                            <td>Clean Slate</td>
                            <td><code>{:policy :clean-slate}</code></td>
                            <td>Delete all rows in <code>:table</code> before seeding</td>
                        </tr>
                      <tr>
                            <td>Dependent</td>
                            <td><code>{:policy :clean-slate :dependents [:pets :children]}</code></td>
                            <td>Apply the specified policy to all tables in <code>:dependents</code></td>
                        </tr>
                    </table>
                </div>
                </div>
            </div>
            </div>
            
            <div class="row" id="support">
            <div class="span9 well">
            
                <div class="row">
                <div class="span4">
                <h1>Support</h1>
                <table class="table">
                    <tr>
                        <td>Database</td>
                        <td>Supported?</td>
                    </tr>
                    <tr class="success">
                        <td>MySQL</td>
                        <td>Yes</td>
                    </tr>
                    <tr class="error">
                        <td>Postgres</td>
                        <td>Not yet implemented</td>
                    </tr>
                    <tr class="error">
                        <td>Oracle</td>
                        <td>Not yet implemented</td>
                    </tr>
                    <tr class="error">
                        <td>MSSQL</td>
                        <td>Not yet implemented</td>
                    </tr>
                    <tr class="error">
                        <td>SQLite</td>
                        <td>Not yet implemented</td>
                    </tr>
                </div>
                </table>
                <div class="span4"></div>
                <h3>MySQL support</h3>
                <table class="table">
                    <tr>
                        <td>MySQL Type</td>
                        <td>Maps to Dibble type</td>
                    </tr>
                    <tr class="success">
                        <td><code>varchar</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>int</code></td>
                        <td><code>:integer</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>float</code></td>
                        <td><code>:decimal</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>double</code></td>
                        <td><code>:decimal</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>decimal</code></td>
                        <td><code>:decimal</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>char</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>tinytext</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>mediumtext</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>text</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>longtext</code></td>
                        <td><code>:string</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>tinyint</code></td>
                        <td><code>:integer</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>smallint</code></td>
                        <td><code>:integer</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>mediumint</code></td>
                        <td><code>:integer</code></td>
                    </tr>
                    <tr class="success">
                        <td><code>bigint</code></td>
                        <td><code>:integer</code></td>
                    </tr>
                    <tr class="error">
                        <td><code>date</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>datetime</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>time</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>timestamp</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>blob</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>mediumblob</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>longblob  </code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>enum</code></td>
                        <td>?</td>
                    </tr>
                    <tr class="error">
                        <td><code>set</code></td>
                        <td>?</td>
                    </tr>
                </table>
                </div>
            </div>
            </div>
        </div>
      </div>
    
    <footer class="footer">
        <div class="container" style="margin:0 auto;">
            Copyright 2012 Michael Drogalis
        </div>
    </footer>
    
    <p id="back-top">
		<a href="#top"><span></span>Back to Top</a>
	</p>

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script src="js/smoothscroll.js"></script>
    <script src="js/app.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
